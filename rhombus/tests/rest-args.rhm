#lang rhombus
import:
  "check.rhm" open
  racket/math open:
    only: sqr

use_static

// ---------------------------
// Positional Rest with &

fun prlist(& xs :: List): xs

check:
  prlist(1, 2, 3)
  [1, 2, 3]

fun
| altprlist(& xs :: List): xs

check:
  altprlist(4, 5, 6)
  [4, 5, 6]

fun
| addition(): 0
| addition(x): x
| addition(x, & y): x + addition(& y)

check:
  addition(1, 2, 3)
  6

check:
  addition(1, & [10, 20, 30])
  61

check:
  [1, 2, & [3, 4]]
  [1, 2, 3, 4]

// ---------------------------
// Keyword Rest with ~&

fun krmap(~& m): m

check:
  krmap(~a: 1, ~b: 2)
  {keyword(~a): 1, keyword(~b): 2}

fun
| altkrmap(~& m): m

check:
  altkrmap(~a: 1, ~b: 2)
  {keyword(~a): 1, keyword(~b): 2}

fun kinetic_energy(~m: m, ~v: v): (1/2) * m * sqr(v)

check:
  kinetic_energy(~m: 2, ~v: 3)
  9
check:
  kinetic_energy(~& {keyword(~m): 4, keyword(~v): 5})
  50
check:
  kinetic_energy(~m: 6, ~& {keyword(~v): 7})
  147
check:
  kinetic_energy(~v: 2, ~& {keyword(~m): 1})
  2

// ---------------------------
// Repetition Rest with ...

def rrlist(x, ...):
  [x, ...]

check:
  rrlist(1, 2, 3)
  [1, 2, 3]

fun
| altrrlist(y, ...): [y, ...]

check:
  altrrlist(4, 5, 6)
  [4, 5, 6]

fun
| add(): 0
| add(x): x
| add(x, y, ...): x + add(y, ...)

check:
  add(1, 2, 3)
  6

val [n :: Integer, ...]: [10, 20, 30]
check:
  add(1, n, ...)
  61

check:
  add(1, List.repet([10, 20, 30]), ...)
  61

check:
  ~print
  match '(1 10) (2 3 4 10) (5 6 10)'
  | '($a ... 10) ...': [[a, ...], ...]
  [['1'], ['2', '3', '4'], ['5', '6']]

check:
  ~print
  val [s, ...]: ["a", "b", "c"]
  '(hi $s) ...'
  '(hi "a") (hi "b") (hi "c")'
  
check:
  ~print
  '(hi $(List.repet(["a", "b", "c"]))) ...'
  '(hi "a") (hi "b") (hi "c")'

class Posn(x, y)

def List(p :: Posn, ...) : [Posn(1, 2), Posn(3, 4)]
check:
  [p, ...][0].x
  1

fun posns_y1(& rst):
  def List(p :: Posn, ...) : rst
  [p, ...][1].y

check:
  posns_y1(Posn(1, 2), Posn(3, 4), Posn(5, 6))
  4

fun posns_y2(& List(p :: Posn, ...)):
  [p, ...][1].y
     
check:
  posns_y2(Posn(1, 2), Posn(3, 4), Posn(5, 6))
  4

fun posns_y(p :: Posn, ...):
  [p, ...][1].y
     
check:
  posns_y(Posn(1, 2), Posn(3, 4), Posn(5, 6))
  4
